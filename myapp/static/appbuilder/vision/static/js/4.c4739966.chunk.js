"use strict";(self.webpackChunkvite_ml_platform=self.webpackChunkvite_ml_platform||[]).push([[4],{14004:function(e,t,a){a.r(t),a.d(t,{default:function(){return v}});var n=a(18489),s=a(50678),l=a(72791),i=a(23695),r=a(83099),o=a(47528),d=a(28183),u=a(64564),c=a(618),m=a(48757),p=a(87309),f=a(99154),y=a(44541),x=a(60238),h={type:"",factory_name:"",name:"",status:"",admin:"",time:""},b=[{type:"select",name:"type",label:"\u7c7b\u578b",options:[{label:"recall",value:"recall"},{label:"sort",value:"sort"},{label:"filter",value:"filter"}]},{type:"input",name:"factory_name",label:"\u5de5\u5382\u540d"},{type:"input",name:"name",label:"\u540d\u79f0"},{type:"select",name:"status",label:"\u72b6\u6001",options:[{value:-1,label:"\u5931\u6548"},{value:0,label:"\u6709\u6548"},{value:1,label:"\u521b\u5efa\u6210\u529f"},{value:2,label:"\u6d4b\u8bd5\u53d1\u5e03"},{value:3,label:"\u6b63\u5f0f\u53d1\u5e03"},{value:4,label:"\u516c\u6709"},{value:5,label:"\u79c1\u6709"}]},{type:"input",name:"admin",label:"\u8d1f\u8d23\u4eba"},{type:"rangePicker",name:"time",label:"\u66f4\u65b0\u65f6\u95f4"}],Z=a(17097),_=a(80184);function v(){var e=(0,l.useState)(!1),t=(0,s.Z)(e,2),a=t[0],v=t[1],j=(0,l.useState)([]),g=(0,s.Z)(j,2),k=g[0],I=g[1],C=(0,l.useState)([]),T=(0,s.Z)(C,2),F=T[0],P=T[1],w=(0,l.useState)({}),S=(0,s.Z)(w,2),q=S[0],E=S[1],Q=(0,l.useState)(!1),R=(0,s.Z)(Q,2),V=R[0],A=R[1],D=(0,l.useState)(!1),N=(0,s.Z)(D,2),O=N[0],z=N[1],B=(0,l.useState)(!1),J=(0,s.Z)(B,2),L=J[0],G=J[1],H=[{title:"#",render:function(e,t,a){return(0,_.jsx)("a",{children:a+1+""})}},{title:"\u56fe\u540d\u79f0",dataIndex:"graph_name",key:"graph_name"},{title:"\u7248\u672c",dataIndex:"version",key:"version"},{title:"\u56fe\u6a21\u677f",dataIndex:"template_name",key:"template_name"},{title:"\u8d1f\u8d23\u4eba",dataIndex:"admin",key:"admin"},{title:"\u66f4\u65b0\u65f6\u95f4",dataIndex:"updated_time",key:"updated_time"},{title:"\u4f7f\u7528\u573a\u666f",dataIndex:"scene_name",key:'"scene_name'},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return(0,_.jsx)(r.Z,{size:"middle",children:(0,_.jsx)("span",{style:{color:"#999"},children:" \u67e5\u770b "})})}}],K=[{title:"#",render:function(e,t,a){return(0,_.jsx)("a",{children:a+1+""})}},{title:"\u7c7b\u578b",dataIndex:"type",key:"type"},{title:"\u7248\u672c",dataIndex:"version",key:"version"},{title:"\u5de5\u5382\u540d",dataIndex:"factory_name",key:"factory_name"},{title:"\u540d\u79f0",dataIndex:"name",key:'"name'},{title:"\u72b6\u6001",dataIndex:"status",key:"status",render:function(e){return(0,_.jsx)(o.Z,{color:Z.a[e]?Z.a[e]:"",children:Z.Q[e]?Z.Q[e]:""})}},{title:"\u8d1f\u8d23\u4eba",dataIndex:"admin",key:"admin"},{title:"\u63cf\u8ff0",dataIndex:"des",key:"des"},{title:"\u66f4\u65b0\u65f6\u95f4",dataIndex:"updated_time",key:"updated_time"}],M=[{title:"#",render:function(e,t,a){return(0,_.jsx)("a",{children:a+1+""})}},{title:"\u7c7b\u578b",fType:"select",foptions:[{label:"recall",value:"recall"},{label:"sort",value:"sort"},{label:"filter",value:"filter"}],dataIndex:"type",key:"type"},{title:"\u5de5\u5382\u540d",fType:"input",dataIndex:"factory_name",key:"factory_name"},{title:"\u540d\u79f0",fType:"input",dataIndex:"name",key:'"name'},{title:"\u8f93\u51fa\u7ed3\u6784\u540d",fType:"input",dataIndex:"output_struct",key:"output_struct"},{title:"\u72b6\u6001",fType:"select",foptions:[{value:-1,label:"\u5931\u6548"},{value:0,label:"\u6709\u6548"},{value:1,label:"\u521b\u5efa\u6210\u529f"},{value:2,label:"\u6d4b\u8bd5\u53d1\u5e03"},{value:3,label:"\u6b63\u5f0f\u53d1\u5e03"},{value:4,label:"\u516c\u6709"},{value:5,label:"\u79c1\u6709"}],dataIndex:"status",key:"status",render:function(e){return(0,_.jsx)(o.Z,{color:Z.a[e]?Z.a[e]:"",children:Z.Q[e]?Z.Q[e]:""})}},{title:"\u8d1f\u8d23\u4eba",fType:"input",dataIndex:"admin",key:"admin"},{title:"\u66f4\u65b0\u65f6\u95f4",fType:"input",dataIndex:"updated_time",key:"updated_time"},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return(0,_.jsxs)(r.Z,{size:"middle",children:[(0,_.jsx)("a",{onClick:function(){A(!1),E((0,n.Z)({},t)),v(!0)},children:"\u67e5\u770b"},"view"),(0,_.jsx)("span",{style:{color:"#999",marginTop:"-1px"},children:" | "}),(0,_.jsx)(d.Z,{title:"\u662f\u5426\u5220\u9664?",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onConfirm:function(){!function(e){var t={opr:"delete_component",data:{type:e.type,factory_name:e.factory_name,name:e.name}};x.Z.delete_component(t).then((function(e){console.log(e),0===e.status?i.ZP.success(e.message):i.ZP.error(e.message)}))}(t)},children:(0,_.jsx)("a",{children:"\u5220\u9664"},"del")}),(0,_.jsx)("span",{style:{color:"#999",marginTop:"-1px"},children:" | "}),(0,_.jsx)("a",{onClick:function(){!function(e){G(!0);var t={opr:"query_component_historys",data:{name:e.name,is_public:4===e.status?1:0,graph_name:e.graph_name}};x.Z.query_component_historys(t).then((function(e){console.log(e),0===e.status?(P(e.data.results),z(!0),i.ZP.success(e.message)):i.ZP.error(e.message)}))}(t)},children:" \u5386\u53f2\u7248\u672c "},"node"),(0,_.jsx)("span",{style:{color:"#999",marginTop:"-1px"},children:" | "}),(0,_.jsxs)("a",{onClick:function(){!function(e){G(!1);var t={opr:"query_associated_graphs",data:{associated_graphs:e.associated_graphs}};x.Z.query_associated_graphs(t).then((function(e){console.log(e),0===e.status?(P(e.data.results),z(!0),i.ZP.success(e.message)):i.ZP.error(e.message)}))}(t)},children:[" \u5173\u8054\u56fe (",t.associated_graphs&&t.associated_graphs.length?t.associated_graphs.length:0,")"]},"node")]})}}],U=M.filter((function(e){return e.fType})).map((function(e){return{type:e.fType,name:e.dataIndex,label:e.title,options:e.foptions?e.foptions:[]}})),W=function(e){var t=e.admin,a=e.factory_name,n=e.type,s=e.name,l=e.time,r={type:n||"",factory_name:a||"",name:s||"",status:e.status||0,admin:t||"",min_updated_time:l&&l[0]?new Date(l[0]).getTime():0,max_updated_time:l&&l[1]?new Date(l[1]).getTime():0};x.Z.query_components({opr:"query_components",data:r}).then((function(e){0===e.status?(I(e.data.results),i.ZP.success(e.message)):i.ZP.error(e.message)}))};(0,l.useEffect)((function(){W({})}),[]);return(0,_.jsxs)("div",{style:{padding:"30px 40px"},children:[(0,_.jsxs)("div",{children:[(0,_.jsx)(u.Z,{title:"\u67e5\u8be2\u6761\u4ef6",children:(0,_.jsx)(f.Z,{formRolue:b,form:h,queryList:W})}),(0,_.jsx)(u.Z,{title:"\u67e5\u8be2\u7ed3\u679c",style:{marginTop:"20px"},children:(0,_.jsx)(c.Z,{columns:M,dataSource:k},"scene_name")})]}),(0,_.jsx)(m.Z,{width:900,title:V?V&&q.version?"\u7f16\u8f91":"\u65b0\u589e":"\u67e5\u770b",visible:a,onCancel:function(){v(!1)},footer:[(0,_.jsx)(p.Z,{onClick:function(){v(!1)},children:"\u5173\u95ed"},"back")],children:(0,_.jsx)(y.Z,{formRolue:U,form:q,isadd:V,showEdit:a,submitForm:function(e){var t=(0,n.Z)({},e);q.version?(t.version=q.version+1,x.Z.mod_scene({opr:"mod_scene",data:t}).then((function(e){0===e.status?(W({}),v(!1),i.ZP.success(e.message)):i.ZP.error(e.message)}))):x.Z.add_scene({opr:"add_scene",data:t}).then((function(e){0===e.status?(W({}),v(!1),i.ZP.success(e.message)):i.ZP.error(e.message)}))},resFied:function(){v(!1),W({})}})}),(0,_.jsx)(m.Z,{width:"80%",title:"\u5173\u8054\u56fe",visible:O,onCancel:function(){z(!1)},footer:[(0,_.jsx)(p.Z,{onClick:function(){z(!1)},children:"\u5173\u95ed"},"back")],children:(0,_.jsx)(c.Z,{columns:L?K:H,dataSource:F},"struct_name")})]})}},44541:function(e,t,a){a.d(t,{Z:function(){return y}});var n=a(50678),s=a(72791),l=a(20135),i=a(58646),r=a(58105),o=a(13295),d=a(73231),u=a(87309),c=a(71939),m=a.n(c),p=a(80184),f=l.Z.TextArea;function y(e){var t=i.Z.useForm(),a=(0,n.Z)(t,1)[0],c=(0,s.useState)({}),y=(0,n.Z)(c,2),x=y[0],h=y[1],b=(0,s.useRef)(null);(0,s.useEffect)((function(){a.resetFields(),a.setFieldsValue(e.form),e.form.map_config&&h(JSON.parse(JSON.stringify(e.form.map_config))),e.saveFrom&&e.saveFrom.graph_name&&a.setFieldsValue(e.saveFrom)}),[]);return(0,p.jsx)("div",{children:(0,p.jsxs)(i.Z,{name:"basic",labelCol:{span:8},style:{width:"80%"},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:function(t){e.submitForm(t,e.opName)},onFinishFailed:function(){console.log("\u5931\u8d25")},autoComplete:"off",ref:b,form:a,children:[e.formRolue.map((function(t){switch(t.type){case"input":return(0,p.jsx)(i.Z.Item,{label:t.label,name:t.name,initialValue:e.form[t.name],rules:[{required:!0,message:"\u8bf7\u8f93\u5165"+t.label}],children:(0,p.jsx)(l.Z,{disabled:!(!e.disableds&&!1!==e.isadd)})},t.name);case"select":return(0,p.jsx)(i.Z.Item,{label:t.label,name:t.name,rules:[{required:!0,message:"\u8bf7\u9009\u62e9"+t.label}],children:(0,p.jsx)(r.Z,{disabled:!(!e.disableds&&!1!==e.isadd),children:t.options?t.options.map((function(e){return(0,p.jsx)(r.Z.Option,{value:e.value,children:e.label},e.value)})):null})},t.name);case"picker":return(0,p.jsx)(i.Z.Item,{label:t.label,name:t.name,rules:[{required:!0,message:"\u8bf7\u9009\u62e9"+t.label}],children:(0,p.jsx)(o.Z,{style:{width:"100%"}})},t.name);case"radio":return(0,p.jsx)(i.Z.Item,{label:t.label,name:t.name,rules:[{required:!0,message:"\u8bf7\u9009\u62e9"+t.label}],children:(0,p.jsx)(d.ZP.Group,{disabled:!(!e.disableds&&!1!==e.isadd),children:t.options?t.options.map((function(e){return(0,p.jsx)(d.ZP,{value:e.value,children:e.label},e.value)})):null})},t.name);case"json":return(0,p.jsx)(i.Z.Item,{label:t.label,name:t.name,children:(0,p.jsx)(m(),{src:x,displayDataTypes:!1,theme:"railscasts",onEdit:function(e){return function(e){return console.log(e),!0}(e)},onAdd:function(e){return function(e){return console.log(e),!0}(e)}})},t.name);case"textArea":return(0,p.jsx)(i.Z.Item,{label:t.label,name:t.name,rules:[{required:!0,message:"\u8bf7\u8f93\u5165"+t.label}],children:(0,p.jsx)(f,{rows:4,disabled:!(!e.disableds&&!1!==e.isadd)})},t.name)}})),(0,p.jsxs)(i.Z.Item,{wrapperCol:{offset:8,span:16},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"center"},children:[0===e.stepCurrent?(0,p.jsx)(u.Z,{onClick:function(){e.setEditStatus(!1),e.setBaseForm&&e.setBaseForm({})},children:"\u8fd4\u56de"}):null,0===e.stepCurrent?(0,p.jsx)(u.Z,{htmlType:"submit",style:{marginLeft:"20px"},children:"\u4e0b\u4e00\u6b65"}):null]}),e.stepCurrent&&0!==e.stepCurrent?(0,p.jsx)(u.Z,{type:"primary",children:"\u63d0\u4ea4"}):null,e.isadd&&void 0===e.stepCurrent?(0,p.jsx)(u.Z,{htmlType:"submit",type:"primary",disabled:!(!e.disableds&&!1!==e.isadd),children:"\u63d0\u4ea4"}):null]})]})})}}}]);