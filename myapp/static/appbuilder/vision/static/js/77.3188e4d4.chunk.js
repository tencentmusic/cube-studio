"use strict";(self.webpackChunkvite_ml_platform=self.webpackChunkvite_ml_platform||[]).push([[77],{83077:function(e,t,r){r.r(t),r.d(t,{default:function(){return F}});var a=r(31303),s=r(33032),n=r(36222),i=r(18489),l=r(50678),u=r(84322),o=r.n(u),c=r(72791),d=r(23695),f=r(58646),m=r(64564),Z=r(66106),_=r(30914),h=r(38243),p=r(58105),g=r(20135),x=r(87309),j=r(79271),v=r(68747),y=r(79286),b=r(31776),I=r(80184),w={uuid:Date.now(),getUUid:function(){return this.uuid++}};function F(){var e=(0,j.k6)(),t=c.createRef(),r=(0,c.useState)({feature_set_id:"",feature_group_name:"",feature_group_desc:"",owner_rtxs:"",feature_user_slot:"",feature_item_slot:"",feature_name:"",feature_desc:"",unique_feature_name:"",timeout:"",hashId:"",resource_info:"",ReFeatureInformationTitle:"\u6ce8\u518c\u7279\u5f81\u4fe1\u606f",group_id:"",sample_id:"",isomerismFeatureInfoArray:[{feature_id:void 0}]}),u=(0,l.Z)(r,2),F=u[0],S=u[1],N=(0,c.useState)([{uuid:w.getUUid(),feature_id:"",feature_desc:"",feature_item_slot:void 0,feature_name:"",feature_user_slot:"",feature_type:[],numer_type:[],ReFeatureInformationTitle:"\u6ce8\u518c\u7279\u5f81\u4fe1\u606f"}]),k=(0,l.Z)(N,2),R=k[0],E=k[1],A=(0,c.useState)([{label:"",value:""}]),T=(0,l.Z)(A,2),C=T[0],P=T[1],O=(0,c.useState)([{label:"",value:""}]),U=(0,l.Z)(O,2),D=U[0],V=U[1],q=(0,c.useState)([{label:"",value:""}]),H=(0,l.Z)(q,2),Q=H[0],Y=H[1],$=(0,c.useState)([{feature_serv_name:"",feature_serv_id:"",feature_serv_type:""}]),J=(0,l.Z)($,2),L=J[0],B=J[1],G=(0,c.useState)([{feature_serv_name:"",feature_serv_id:"",feature_serv_type:""}]),K=(0,l.Z)(G,2),z=K[0],M=K[1],W=(0,c.useState)([]),X=(0,l.Z)(W,2),ee=X[0],te=X[1],re=(0,c.useState)(!0),ae=(0,l.Z)(re,2),se=ae[0],ne=ae[1],ie=(0,c.useState)([{label:"",value:""}]),le=(0,l.Z)(ie,2),ue=le[0],oe=le[1];function ce(e){b.Z.featureDisplaySetGetQuest(e,!0,!0).then((function(e){if(0===e.retcode){var t=e.result.featureServRouter;B(t)}else e.retmsg&&d.ZP.error("\u5931\u8d25\u539f\u56e0: ".concat(e.retmsg))}))}(0,c.useEffect)((function(){b.Z.featureKVDataDisplayPostQuest({class:"FEATURE,DATASOURCES,FEATURETYPE,FEATURESTYLE"}).then((function(e){if(0===e.retcode){var t=e.result.data.FEATURE,r=e.result.data.DATASOURCES,a=e.result.data.FEATURETYPE,s=e.result.data.FEATURESTYLE;P(t),oe(r),V(a),Y(s),d.ZP.success("\u67e5\u8be2\u6210\u529f")}else e.retmsg&&d.ZP.error("\u5931\u8d25\u539f\u56e0: ".concat(e.retmsg))}));var r,a,s,n,l={};e.location.state?(l=e.location.state,sessionStorage.setItem("keyIDChilder",JSON.stringify(l)),"4"===l.source_type?ne(!1):ne(!0),S((0,i.Z)({},l)),"\u4fee\u6539\u6ce8\u518c\u7279\u5f81\u4fe1\u606f"===l.ReFeatureInformationTitle?(ce(l.feature_set_id),null===(r=t.current)||void 0===r||r.setFieldsValue((0,i.Z)((0,i.Z)({},l),{},{strategy_ids:l.strategy_ids})),E(l.isomerismFeatureInfoArray)):(null===(a=t.current)||void 0===a||a.setFieldsValue((0,i.Z)((0,i.Z)({},l),{},{strategy_ids:l.strategy_ids})),E(l.isomerismFeatureInfoArray?l.isomerismFeatureInfoArray:[]),ce(l.sample_id))):("4"===(l=JSON.parse(sessionStorage.getItem("keyIDChilder")||"")).source_type?ne(!1):ne(!0),S((0,i.Z)({},l)),"\u4fee\u6539\u6ce8\u518c\u7279\u5f81\u4fe1\u606f"===l.ReFeatureInformationTitle?(ce(l.feature_set_id),null===(s=t.current)||void 0===s||s.setFieldsValue((0,i.Z)((0,i.Z)({},l),{},{strategy_ids:l.strategy_ids})),E(l.isomerismFeatureInfoArray)):(null===(n=t.current)||void 0===n||n.setFieldsValue((0,i.Z)((0,i.Z)({},l),{},{strategy_ids:l.strategy_ids})),E(l.isomerismFeatureInfoArray?l.isomerismFeatureInfoArray:[]),ce(l.sample_id||l.feature_set_id)))}),[]),(0,c.useEffect)((function(){for(var e=0;e<R.length;e++){var r,a;null===(r=t.current)||void 0===r||r.setFieldsValue((a={},(0,n.Z)(a,"feature_id".concat(e),R[e].feature_id),(0,n.Z)(a,"feature_name".concat(e),R[e].feature_name),(0,n.Z)(a,"feature_desc".concat(e),R[e].feature_desc),(0,n.Z)(a,"feature_type".concat(e),R[e].feature_type),(0,n.Z)(a,"numer_type".concat(e),R[e].numer_type),(0,n.Z)(a,"feature_user_slot".concat(e),R[e].feature_user_slot),(0,n.Z)(a,"feature_item_slot".concat(e),R[e].feature_item_slot),(0,n.Z)(a,"hashId".concat(e),R[e].hashId),(0,n.Z)(a,"unique_feature_name".concat(e),R[e].unique_feature_name),a))}}),[R]);var de=function(){var e=(0,s.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fe();case 3:t=e.sent,E([].concat((0,a.Z)(t),[{uuid:w.getUUid(),feature_id:"",feature_desc:t.feature_desc,feature_item_slot:t.feature_item_slot,feature_name:"",feature_user_slot:"",feature_type:[],numer_type:[],ReFeatureInformationTitle:"\u6ce8\u518c\u7279\u5f81\u4fe1\u606f"}])),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),fe=function(){return new Promise((function(e,r){try{var a,s=null===(a=t.current)||void 0===a?void 0:a.getFieldsValue(),n=/(\d+)$/,u=[],o={};Object.entries(s).forEach((function(e){var t=(0,l.Z)(e,2),r=t[0],a=t[1];if(n.test(r)){var s=RegExp.$1;u[s]||(u[s]={}),u[s][r.substring(0,r.length-String(s).length)]=a}else o[r]=a})),e(u.map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{uuid:w.getUUid()})})))}catch(c){r(c)}}))},me=function(){var e=(0,s.Z)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=ee.slice()).push(t),te(r),t.uuid&&E(R.filter((function(e){return e.uuid!==t.uuid}))),t.uuid||E(R.filter((function(e){return e.feature_id!==t.feature_id})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ze={rules:[{required:!0,message:"Please select time!"}]};return(0,I.jsx)("div",{className:"SceneRegistrationClass",children:(0,I.jsxs)("div",{className:"bodyClass",children:[(0,I.jsx)("div",{className:"SceneHeader",children:F.ReFeatureInformationTitle}),(0,I.jsx)("div",{className:"site-card-border-less-wrapper",children:(0,I.jsxs)(f.Z,{ref:t,name:"IsomerismFeatureInfoArray",onFinish:function(t){var r=/(\d+)$/,s=[],n={};Object.entries(t).forEach((function(e){var t=(0,l.Z)(e,2),a=t[0],i=t[1];if(r.test(a)){var u=RegExp.$1;s[u]||(s[u]={}),s[u][a.substring(0,a.length-String(u).length)]=i}else n[a]=i}));var u=R[R.length-1].feature_id;if("\u67e5\u770b\u6ce8\u518c\u7279\u5f81\u4fe1\u606f"===F.ReFeatureInformationTitle&&e.push("/HeterogeneousPlatform/Nationalkaraoke/FeatureSetConfiguration"),"\u4fee\u6539\u6ce8\u518c\u7279\u5f81\u4fe1\u606f"===F.ReFeatureInformationTitle){if(F.group_id){var o=ee.map((function(e){return{feature_id:e.feature_id,isDel:1}})),c=s.concat(o),f=Object.assign((0,i.Z)((0,i.Z)({},n),{},{group_id:F.group_id}),{isomerismFeatureInfoArray:(0,a.Z)(c)}),m={};if(function e(t,r){if("[object Object]"===Object.prototype.toString.call(t)&&"[object Object]"===Object.prototype.toString.call(r))for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var s=t[a],n=r[a];if(Array.isArray(s))for(var i=0;i<s.length;i++)for(var l=0;l<n.length;l++)e(s[i],n[l]);else t[a]!==r[a]&&(m[a]=r[a])}}(F,f),b.Z.featureUpdateIsomerismFeatureFeatureInfoQUEST(f).then((function(t){0===t.retcode?(e.push("/HeterogeneousPlatform/Nationalkaraoke/FeatureSetConfiguration"),d.ZP.success("\u4fee\u6539\u6ce8\u518c\u7279\u5f81\u4fe1\u606f")):t.retmsg&&d.ZP.error("\u5931\u8d25\u539f\u56e0: ".concat(t.retmsg))})),""===u){var Z=s.filter((function(e){return!e.feature_id&&(delete e.feature_id,e)})),_=Object.assign({group_id:F.group_id},{isomerismFeatureInfoArray:(0,a.Z)(Z)});b.Z.featureRegisterIsomerismFeatureFeatureInfoPostQuest(_).then((function(t){0===t.retcode?(e.push("/HeterogeneousPlatform/Nationalkaraoke/FeatureSetConfiguration"),d.ZP.success("\u65b0\u589e\u6210\u529f")):t.retmsg&&d.ZP.error("\u5931\u8d25\u539f\u56e0: ".concat(t.retmsg))}))}}}else if("\u6ce8\u518c\u7279\u5f81\u4fe1\u606f"===F.ReFeatureInformationTitle){var h=s.filter((function(e){return!e.feature_id&&(delete e.feature_id,e)})),p=Object.assign((0,i.Z)((0,i.Z)({},n),{},{feature_set_id:F.sample_id||F.feature_set_id}),{isomerismFeatureInfoArray:(0,a.Z)(h)});b.Z.featureRegisterIsomerismFeatureFeatureInfoPostQuest(p).then((function(t){0===t.retcode?(e.push("/HeterogeneousPlatform/Nationalkaraoke/FeatureSetConfiguration"),d.ZP.success("\u67e5\u8be2\u6210\u529f")):t.retmsg&&d.ZP.error("\u5931\u8d25\u539f\u56e0: ".concat(t.retmsg))}))}},autoComplete:"off",layout:"vertical",children:[(0,I.jsx)(m.Z,{title:"\u57fa\u672c\u4fe1\u606f",bordered:!1,children:(0,I.jsxs)(Z.Z,{gutter:16,children:[(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,{label:"\u7279\u5f81\u7ec4id",name:"feature_set_id",children:(0,I.jsx)(h.Z,{disabled:!0,placeholder:"\u8bf7\u8f93\u5165\u7269\u54c1slot",style:{width:200}})})}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,(0,i.Z)((0,i.Z)({label:"\u7279\u5f81\u7ec4\u7c7b\u578b",name:"feature_group_type"},Ze),{},{children:(0,I.jsx)(p.Z,{placeholder:"\u8bf7\u9009\u62e9\u7279\u5f81\u7ec4\u7c7b\u578b",style:{width:"200px"},children:C.map((function(e){return(0,I.jsx)(p.Z.Option,{value:e.value,children:e.label},e.label)}))})}))}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,(0,i.Z)((0,i.Z)({label:"\u7279\u5f81\u7ec4\u540d\u79f0",name:"feature_group_name"},Ze),{},{children:(0,I.jsx)(g.Z,{placeholder:"\u8bf7\u8f93\u5165\u7279\u5f81\u7ec4\u540d\u79f0",style:{width:200}})}))}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,(0,i.Z)((0,i.Z)({label:"\u7279\u5f81\u7ec4\u63cf\u8ff0",name:"feature_group_desc"},Ze),{},{children:(0,I.jsx)(g.Z,{placeholder:"\u8bf7\u8f93\u5165\u7279\u5f81\u7ec4\u63cf\u8ff0",style:{width:200}})}))}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,(0,i.Z)((0,i.Z)({label:"\u8d23\u4efb\u4eba",name:"owner_rtxs"},Ze),{},{children:(0,I.jsx)(g.Z,{placeholder:"\u8bf7\u8f93\u5165\u8d23\u4efb\u4eba",style:{width:200}})}))})]})}),(0,I.jsx)(m.Z,{title:"\u5b58\u50a8\u4fe1\u606f",bordered:!1,children:(0,I.jsxs)(Z.Z,{gutter:16,children:[(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,(0,i.Z)((0,i.Z)({label:"\u6570\u636e\u6765\u6e90",name:"source_type"},Ze),{},{children:(0,I.jsx)(p.Z,{placeholder:"\u8bf7\u9009\u62e9\u6570\u636e\u6765\u6e90",style:{width:"200px"},onChange:function(e){var r;ne("4"!==e),null===(r=t.current)||void 0===r||r.setFieldsValue({resource_info:""});var a=L.filter((function(t){if(t.feature_serv_type===e)return{value:t.feature_serv_id,key:t.feature_serv_id,label:t.feature_serv_name}}));M(a)},children:ue.map((function(e){return(0,I.jsx)(p.Z.Option,{value:e.value,children:e.label},e.label)}))})}))}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,(0,i.Z)((0,i.Z)({label:"\u7279\u5f81\u670d\u52a1",name:"resource_info"},Ze),{},{children:(0,I.jsx)(p.Z,{placeholder:"\u8bf7\u9009\u62e9\u7279\u5f81\u670d\u52a1",style:{width:"200px"},children:z.map((function(e){return(0,I.jsx)(p.Z.Option,{value:e.feature_serv_id,children:e.feature_serv_name},e.feature_serv_id)}))})}))}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,(0,i.Z)((0,i.Z)({label:"\u8fc7\u671f\u65f6\u95f4",name:"timeout"},Ze),{},{children:(0,I.jsx)(h.Z,{addonAfter:"ms",placeholder:"\u8bf7\u8f93\u5165\u8fc7\u671f\u65f6\u95f4",style:{width:200}})}))})]})}),(0,I.jsxs)(m.Z,{title:"\u7279\u5f81\u5b57\u6bb5\u4fe1\u606f",bordered:!1,children:[(0,I.jsx)(f.Z.Item,{children:R.map((function(e,t){return(0,I.jsxs)(Z.Z,{gutter:16,children:[(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,{label:"\u7279\u5f81ID",name:"feature_id".concat(t),children:(0,I.jsx)(g.Z,{disabled:!0,placeholder:"\u8bf7\u8f93\u5165\u7279\u5f81\u82f1\u6587\u540d",style:{width:200}})})}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,(0,i.Z)((0,i.Z)({label:"\u7279\u5f81\u82f1\u6587\u540d",name:"feature_name".concat(t)},Ze),{},{children:(0,I.jsx)(g.Z,{disabled:!!e.feature_name,placeholder:"\u8bf7\u8f93\u5165\u7279\u5f81\u82f1\u6587\u540d",style:{width:200}})}))}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,(0,i.Z)((0,i.Z)({label:"\u7279\u5f81\u4e2d\u6587\u540d",name:"feature_desc".concat(t)},Ze),{},{children:(0,I.jsx)(g.Z,{placeholder:"\u8bf7\u8f93\u5165\u7279\u5f81\u4e2d\u6587\u540d",style:{width:200}})}))}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,{label:"\u552f\u4e00\u7279\u5f81\u540d",name:"unique_feature_name".concat(t),children:(0,I.jsx)(g.Z,{disabled:!0,placeholder:"\u8bf7\u8f93\u5165\u552f\u4e00\u7279\u5f81\u540d",style:{width:200}})})}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,(0,i.Z)((0,i.Z)({label:"\u7279\u5f81\u683c\u5f0f",name:"feature_type".concat(t)},Ze),{},{children:(0,I.jsx)(p.Z,{placeholder:"\u8bf7\u9009\u62e9\u7279\u5f81\u670d\u52a1",style:{width:"200px"},children:Q.map((function(e){return(0,I.jsx)(p.Z.Option,{value:e.value,children:e.label},e.label)}))})}))}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,(0,i.Z)((0,i.Z)({label:"\u7279\u5f81\u7c7b\u578b",name:"numer_type".concat(t)},Ze),{},{children:(0,I.jsx)(p.Z,{placeholder:"\u8bf7\u9009\u62e9\u7279\u5f81\u7c7b\u578b",style:{width:"200px"},children:D.map((function(e){return(0,I.jsx)(p.Z.Option,{value:e.value,children:e.label},e.label)}))})}))}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,(0,i.Z)((0,i.Z)({label:"\u7528\u6237slot",name:"feature_user_slot".concat(t)},Ze),{},{children:(0,I.jsx)(h.Z,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237slot",style:{width:200}})}))}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,(0,i.Z)((0,i.Z)({label:"\u7269\u54c1slot",name:"feature_item_slot".concat(t)},Ze),{},{children:(0,I.jsx)(h.Z,{placeholder:"\u8bf7\u8f93\u5165\u7269\u54c1slot",style:{width:200}})}))}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,{label:"hashId",name:"hashId".concat(t),children:(0,I.jsx)(g.Z,{disabled:se,style:{width:200}})})}),(0,I.jsx)(_.Z,{className:"gutter-row",span:8,children:(0,I.jsx)(f.Z.Item,{children:(0,I.jsx)(x.Z,{className:"ButtonClass",type:"dashed",onClick:function(){return me(e)},block:!0,icon:(0,I.jsx)(v.Z,{})})})})]},t)}))}),(0,I.jsx)(f.Z.Item,{children:(0,I.jsx)(x.Z,{type:"dashed",onClick:de,block:!0,icon:(0,I.jsx)(y.Z,{}),children:"\u65b0\u589e"})}),(0,I.jsx)(f.Z.Item,{children:(0,I.jsxs)("div",{className:"preservationClass",children:[(0,I.jsx)(x.Z,{style:{backgroundColor:"rgba(255, 87, 51, 1)",width:"140px",height:"40px",marginRight:"10px"},onClick:function(){return e.go(-1)},type:"primary",children:"\u8fd4\u56de"}),(0,I.jsx)(x.Z,{type:"primary",htmlType:"submit",style:{backgroundColor:"rgba(255, 87, 51, 1)",width:" 140px",height:"40px"},children:"\u67e5\u770b\u6ce8\u518c\u7279\u5f81\u4fe1\u606f"===F.ReFeatureInformationTitle?"\u8fd4\u56de":"\u4fdd\u5b58"})]})})]})]})})]})})}}}]);